// Values from http://paulbourke.net/geometry/polygonise/

const int edges[256] = {
    0x0,
    0x109,
    0x203,
    0x30a,
    0x406,
    0x50f,
    0x605,
    0x70c,
    0x80c,
    0x905,
    0xa0f,
    0xb06,
    0xc0a,
    0xd03,
    0xe09,
    0xf00,
    0x190,
    0x99,
    0x393,
    0x29a,
    0x596,
    0x49f,
    0x795,
    0x69c,
    0x99c,
    0x895,
    0xb9f,
    0xa96,
    0xd9a,
    0xc93,
    0xf99,
    0xe90,
    0x230,
    0x339,
    0x33,
    0x13a,
    0x636,
    0x73f,
    0x435,
    0x53c,
    0xa3c,
    0xb35,
    0x83f,
    0x936,
    0xe3a,
    0xf33,
    0xc39,
    0xd30,
    0x3a0,
    0x2a9,
    0x1a3,
    0xaa,
    0x7a6,
    0x6af,
    0x5a5,
    0x4ac,
    0xbac,
    0xaa5,
    0x9af,
    0x8a6,
    0xfaa,
    0xea3,
    0xda9,
    0xca0,
    0x460,
    0x569,
    0x663,
    0x76a,
    0x66,
    0x16f,
    0x265,
    0x36c,
    0xc6c,
    0xd65,
    0xe6f,
    0xf66,
    0x86a,
    0x963,
    0xa69,
    0xb60,
    0x5f0,
    0x4f9,
    0x7f3,
    0x6fa,
    0x1f6,
    0xff,
    0x3f5,
    0x2fc,
    0xdfc,
    0xcf5,
    0xfff,
    0xef6,
    0x9fa,
    0x8f3,
    0xbf9,
    0xaf0,
    0x650,
    0x759,
    0x453,
    0x55a,
    0x256,
    0x35f,
    0x55,
    0x15c,
    0xe5c,
    0xf55,
    0xc5f,
    0xd56,
    0xa5a,
    0xb53,
    0x859,
    0x950,
    0x7c0,
    0x6c9,
    0x5c3,
    0x4ca,
    0x3c6,
    0x2cf,
    0x1c5,
    0xcc,
    0xfcc,
    0xec5,
    0xdcf,
    0xcc6,
    0xbca,
    0xac3,
    0x9c9,
    0x8c0,
    0x8c0,
    0x9c9,
    0xac3,
    0xbca,
    0xcc6,
    0xdcf,
    0xec5,
    0xfcc,
    0xcc,
    0x1c5,
    0x2cf,
    0x3c6,
    0x4ca,
    0x5c3,
    0x6c9,
    0x7c0,
    0x950,
    0x859,
    0xb53,
    0xa5a,
    0xd56,
    0xc5f,
    0xf55,
    0xe5c,
    0x15c,
    0x55,
    0x35f,
    0x256,
    0x55a,
    0x453,
    0x759,
    0x650,
    0xaf0,
    0xbf9,
    0x8f3,
    0x9fa,
    0xef6,
    0xfff,
    0xcf5,
    0xdfc,
    0x2fc,
    0x3f5,
    0xff,
    0x1f6,
    0x6fa,
    0x7f3,
    0x4f9,
    0x5f0,
    0xb60,
    0xa69,
    0x963,
    0x86a,
    0xf66,
    0xe6f,
    0xd65,
    0xc6c,
    0x36c,
    0x265,
    0x16f,
    0x66,
    0x76a,
    0x663,
    0x569,
    0x460,
    0xca0,
    0xda9,
    0xea3,
    0xfaa,
    0x8a6,
    0x9af,
    0xaa5,
    0xbac,
    0x4ac,
    0x5a5,
    0x6af,
    0x7a6,
    0xaa,
    0x1a3,
    0x2a9,
    0x3a0,
    0xd30,
    0xc39,
    0xf33,
    0xe3a,
    0x936,
    0x83f,
    0xb35,
    0xa3c,
    0x53c,
    0x435,
    0x73f,
    0x636,
    0x13a,
    0x33,
    0x339,
    0x230,
    0xe90,
    0xf99,
    0xc93,
    0xd9a,
    0xa96,
    0xb9f,
    0x895,
    0x99c,
    0x69c,
    0x795,
    0x49f,
    0x596,
    0x29a,
    0x393,
    0x99,
    0x190,
    0xf00,
    0xe09,
    0xd03,
    0xc0a,
    0xb06,
    0xa0f,
    0x905,
    0x80c,
    0x70c,
    0x605,
    0x50f,
    0x406,
    0x30a,
    0x203,
    0x109,
    0x0
};

const int triangulation[256][2] = {
    {-1, -1},
    {138412031, -1},
    {27262975, -1},
    {406422015, -1},
    {313524223, -1},
    {137439999, -1},
    {-1834997249, -1},       
    {674408617, -1879048193},
    {993001471, -1},
    {187216127, -1},
    {419576831, -1},
    {455187352, -1073741825},
    {974889983, -1},
    {168856203, -1342177281},
    {956545466, -1610612737},
    {-1733653505, -1},       
    {1200619519, -1},        
    {1124545791, -1},        
    {26757119, -1},
    {1100247411, 536870911}, 
    {313018367, -1},
    {879952914, -1342177281},
    {-1834417532, 2147483647},
    {714250023, 932511743},
    {-2072792321, -1},
    {-1266998240, 1342177279},
    {-1877457117, -1073741825},
    {1203325851, 690094079},
    {974371448, 1342177279},
    {463555344, 1203044351},
    {1200163739, -1425801217},
    {1203026331, -1342177281},
    {-1789919233, -1},
    {-1790934017, -1},
    {88166655, -1},
    {-2058865359, 1610612735},
    {313087231, -1},
    {813771337, 1610612735},
    {1386562112, 805306367},
    {710092085, 1128857599},
    {-1790821377, -1},
    {186682185, 1610612735},
    {88085795, -1073741825},
    {559044648, -1266286593},
    {-1548086379, 1342177279},
    {1230012810, 414908415},
    {1409616731, -1425801217},
    {1418037928, -1073741825},
    {-1752860161, -1},
    {-1828105385, 1073741823},
    {125835029, 2147483647},
    {355686399, -1},
    {-1752606815, 805306367},
    {-1591127981, 91488255},
    {-2144852603, 2052259839},
    {710038325, 2147483647},
    {2035779899, 805306367},
    {-1787202926, 41680895},
    {598743063, -2124939265},
    {-1306847375, 1610612735},
    {-1786226783, 977010687},
    {1459947899, 17480207},
    {-1173683291, 134698767},
    {-1168656897, -1},
    {-1503657985, -1},
    {137733887, -1},
    {-1877629185, -1},
    {405903450, 1879048191},
    {374497791, -1},
    {374416944, -1879048193},
    {-1772550654, 1879048191},
    {1501921874, 1663631359},
    {599418367, -1},
    {-1333059418, 1610612735},
    {26360666, 1879048191},
    {1516343963, 697040895},
    {1672893265, 1073741823},
    {145798405, 364314623},
    {996161030, 1348075519},
    {1704369081, -1879048193},
    {1516534015, -1},
    {1124365157, -1342177281},
    {419800708, 2147483647},
    {-1504602345, 932511743},
    {1629901127, -1879048193},
    {307570224, 1128792063},
    {-2072443642, 1344733183},
    {1939313714, -1785321825},
    {992445606, 1610612735},
    {1516532290, 41680895},
    {26507299, -1247346689},
    {-1843809644, -1212917137},
    {-2072791755, 364314623},
    {1370863120, -1212939073},
    {93349123, 1801684095},
    {1704368967, -1749417985},
    {-1533654273, -1},
    {1248107016, 1073741823},
    {-1608884124, 268435455},
    {-2095573370, 1176174591},
    {345056294, 1342177279},
    {813771044, -1838874625},
    {38020863, -1},
    {-2094521278, 1879048191},
    {-1533385550, 1073741823},
    {136481609, -1532559361},
    {991958534, 1176174591},
    {1679170120, 303794975},
    {-1773586799, 996409343},
    {-1961357130, 420766751},
    {996368390, 1342177279},
    {1686857983, -1},
    {2053606025, -1342177281},
    {120629001, -1501888513},
    {-1502501097, -2122252289},
    {-1501925097, 1073741823},
    {308373528, -1738014721},
    {647139687, -1869384801},
    {2013726304, 805306367},
    {1931899647, -1},
    {599419048, -1738014721},
    {544373513, 1987746431},
    {402749466, 1987716031},
    {-1306847322, 376569855},
    {-1989646447, 1801655151},
    {152791039, -1},
    {2013726267, 190906367},
    {2070937599, -1},
    {1992294399, -1},
    {814446335, -1},
    {26965759, -1},
    {-2120732233, 1879048191},
    {-1591298049, -1},
    {312674411, 2147483647},
    {688040299, 2147483647},
    {1802675112, 983105535},
    {1916151807, -1},
    {1887920226, 268435455},
    {660748033, -1610612737},
    {371295769, -2005467137},
    {-1486219501, 2147483647},
    {-1486783976, 1896415231},
    {57702922, -1767374849},
    {1990699146, -1610612737},
    {1749780223, -1},
    {917702148, 1879048191},
    {-2034743664, 536870911},
    {-1805032557, 456589311},
    {1749465130, 536870911},
    {312675078, -1337524225},
    {1266969346, -1834352641},
    {-1455803756, 993412671},
    {-2110242234, 805306367},
    {69493503, -1},
    {419574820, 1681457151},
    {423707172, 1879048191},
    {-2127011452, 1721892863},
    {-1593178528, 1342177279},
    {1177827434, 809085247},
    {-1454988033, -1},
    {1230466047, -1},
    {137663927, 1879048191},
    {1343570038, -1073741825},
    {-1217907659, 1125515263},
    {-1790307722, -1073741825},
    {1802578440, 882245631},
    {1991592514, -1543307265},
    {881022002, 1515370351},
    {1916232276, -1610612737},
    {-1790933498, 646447103},
    {908293653, 88145919},
    {1652983585, -2071652977},
    {-1790306793, 1631059967},
    {379680272, 2020644175},
    {1084531971, -1498990673},
    {1990699092, -1534394369},
    {1767291320, -1610612737},
    {917529349, 1620443135},
    {192961281, 1433141247},
    {1798714707, 536870911},
    {313088923, -1957232641},
    {187722505, 1701384879},
    {-1201973632, 1515323999},
    {1798714666, 978583551},
    {1486170198, 595787775},
    {-1788256250, 805306367},
    {360808534, -2088607089},
    {358749951, -1},
    {325151288, 1701415279},
    {-1593178475, 90243071},
    {59075327, -1},
    {-1519386625, -1},
    {-1247323137, -1},
    {-1247054461, 268435455},
    {1534438169, 268435455},
    {-1487226984, 405929983},
    {-1322552971, 536870911},
    {137438999, 1462501375},
    {-1755764848, 582483967},
    {1965501273, 589862959},
    {631387447, 1610612735},
    {-2113383801, 1512439807},
    {-1877630125, 1940062207},
    {-1742134905, 707097903},
    {324236799, -1},
    {141586711, 1610612735},
    {-1875298989, 2147483647},
    {-1737123841, -1},
    {1480960171, -1879048193},
    {1346744410, -1154416641},
    {26757770, -1169817601},
    {-1421195853, 1229009231},
    {621970731, -2074542081},
    {78689093, -1297002049},
    {38820139, 1415100511},
    {-1806519297, -1},
    {631460404, 1401225215},
    {1512383554, 268435455},
    {975395384, 1415053727},
    {1512383513, 692256767},
    {-2074586315, 536870911},
    {72418815, -1},
    {-2074586224, 1345716223},
    {-1805647873, -1},
    {1265933210, -1073741825},
    {137664411, 2041315327},
    {447853588, 122421247},
    {826492954, 1196141391},
    {1266267282, -1189937153},
    {-1756776559, -1297020865},
    {-1219804636, 268435455},
    {-1219804541, 1126498303},
    {698513699, 2001338367},
    {-1703316318, 2020614271},
    {933470836, -1583333201},
    {438859007, -1},
    {1226053489, 1073741823},
    {1226053384, 410124287},
    {1077363711, -1},
    {1216348159, -1},
    {-1702184705, -1},
    {814980025, -1342177281},
    {27306122, -1073741825},
    {833305343, -1},
    {313637275, -1879048193},
    {814979858, -1833304065},
    {45616127, -1},
    {851443711, -1},
    {595757736, -1610612737},
    {-1709141249, -1},
    {595757569, -2119630849},
    {439353343, -1},
    {327751935, -1},
    {153092095, -1},
    {59768831, -1},
    {-1, -1}
    };

int UnpackTriangulation(int configurationIndex, int i)
{
    int a;
    if(i < 8)
        a = triangulation[configurationIndex][0];
    else
    {
        a = triangulation[configurationIndex][1];
        i -= 8;
    }

    return ((a >> ((7-i)*4)) & 15);
}

const int cornerIndexAFromEdge[12] = {
    0,
    1,
    2,
    3,
    4,
    5,
    6,
    7,
    0,
    1,
    2,
    3
};

const int cornerIndexBFromEdge[12] = {
    1,
    2,
    3,
    0,
    5,
    6,
    7,
    4,
    4,
    5,
    6,
    7
};